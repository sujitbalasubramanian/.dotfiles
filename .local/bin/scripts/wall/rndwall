#!/bin/sh

if ! [ -x "$(command -v feh)" ]; then
    echo "Error: feh is not installed. please install feh."
    exit 1
fi

while getopts ":o:t:f:" opt ; do
    case $opt in
        o) option=$OPTARG;;
        t) randomtime=$OPTARG;;
        f) format=$OPTARG;;
        \?) echo "Invalid option -$OPTARG" >&2 ;;
    esac
done

wall(){
    if [ ! -z "$randomtime" ]; then
        case $format in
            "order" | "o")
                walllist=$(find ~/.config/randomwall/ -type f | sort)
                while true ; do
                    for i in $walllist; do
                        feh --bg-scale --no-fehbg $i && sleep $randomtime
                    done
                done ;;
            "random" | "r" | "")
                while true ; do
                    feh -z --bg-scale --no-fehbg ~/.config/randomwall && sleep $randomtime
                done ;;
            *)
                echo "format not found";;
        esac 
    else
        echo "time not specified for example try -t 10 "
    fi
}

case $option in
    "")
        if [ -L ~/.config/randomwall ]; then
            wall
        fi ;;
    "set" | "s")
        ln -sfn $(find $HOME/Pictures/wallpapers/ -type d | dmenu -i -p "path :") $HOME/.config/randomwall && wall ;;
    *)
        echo "Invalid option" ;;
esac

